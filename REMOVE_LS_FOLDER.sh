#!/bin/bash
# –°–∫—Ä–∏–ø—Ç –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ —É–¥–∞–ª–µ–Ω–∏—è –ø–∞–ø–∫–∏ /var/www/ls
# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ: ./REMOVE_LS_FOLDER.sh

set -e

echo "üóëÔ∏è  –£–¥–∞–ª–µ–Ω–∏–µ –ø–∞–ø–∫–∏ /var/www/ls"
echo ""

# –¶–≤–µ—Ç–∞ –¥–ª—è –≤—ã–≤–æ–¥–∞
GREEN='\033[0;32m'
YELLOW='\033[1;33m'
RED='\033[0;31m'
NC='\033[0m' # No Color

# –ü—Ä–æ–≤–µ—Ä—è–µ–º, —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –ª–∏ –ø–∞–ø–∫–∞
if [ ! -d "/var/www/ls" ]; then
    echo -e "${GREEN}‚úÖ –ü–∞–ø–∫–∞ /var/www/ls –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç, —É–¥–∞–ª—è—Ç—å –Ω–µ—á–µ–≥–æ${NC}"
    exit 0
fi

echo -e "${YELLOW}‚ö†Ô∏è  –í–ù–ò–ú–ê–ù–ò–ï: –ë—É–¥–µ—Ç —É–¥–∞–ª–µ–Ω–∞ –ø–∞–ø–∫–∞ /var/www/ls${NC}"
echo ""
echo "–ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –Ω–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ –≤ —ç—Ç–æ–π –ø–∞–ø–∫–µ..."

# –ü—Ä–æ–≤–µ—Ä—è–µ–º PM2 –ø—Ä–æ—Ü–µ—Å—Å—ã
echo ""
echo "üìä –ü—Ä–æ–≤–µ—Ä–∫–∞ PM2 –ø—Ä–æ—Ü–µ—Å—Å–æ–≤:"
pm2 list | grep -E "(luxon|ls)" || echo "   –ù–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ —Å 'luxon' –∏–ª–∏ 'ls' –≤ –Ω–∞–∑–≤–∞–Ω–∏–∏"

# –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –ø–∞–ø–∫–∞ /var/www/luxon —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
if [ ! -d "/var/www/luxon" ]; then
    echo -e "${RED}‚ùå –û–®–ò–ë–ö–ê: –ü–∞–ø–∫–∞ /var/www/luxon –Ω–µ –Ω–∞–π–¥–µ–Ω–∞!${NC}"
    echo "   –ù–µ —É–¥–∞–ª—è–µ–º /var/www/ls, —Ç–∞–∫ –∫–∞–∫ –ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –ø–∞–ø–∫–∞ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç"
    exit 1
fi

echo -e "${GREEN}‚úÖ –ü–∞–ø–∫–∞ /var/www/luxon —Å—É—â–µ—Å—Ç–≤—É–µ—Ç${NC}"

# –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ä–∞–∑–º–µ—Ä –ø–∞–ø–∫–∏
echo ""
echo "üì¶ –†–∞–∑–º–µ—Ä –ø–∞–ø–∫–∏ /var/www/ls:"
du -sh /var/www/ls 2>/dev/null || echo "   –ù–µ —É–¥–∞–ª–æ—Å—å –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Ä–∞–∑–º–µ—Ä"

# –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ
echo ""
echo "üìÅ –°–æ–¥–µ—Ä–∂–∏–º–æ–µ /var/www/ls:"
ls -la /var/www/ls | head -20

# –ó–∞–ø—Ä–∞—à–∏–≤–∞–µ–º –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ
echo ""
echo -e "${YELLOW}‚ö†Ô∏è  –í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å /var/www/ls?${NC}"
echo "   –≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–æ–±—Ä–∞—Ç–∏–º–æ!"
echo ""
read -p "–í–≤–µ–¥–∏—Ç–µ 'yes' –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è: " confirm

if [ "$confirm" != "yes" ]; then
    echo -e "${YELLOW}‚ùå –£–¥–∞–ª–µ–Ω–∏–µ –æ—Ç–º–µ–Ω–µ–Ω–æ${NC}"
    exit 0
fi

# –°–æ–∑–¥–∞–µ–º —Ä–µ–∑–µ—Ä–≤–Ω—É—é –∫–æ–ø–∏—é (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
echo ""
echo "üíæ –°–æ–∑–¥–∞–µ–º —Ä–µ–∑–µ—Ä–≤–Ω—É—é –∫–æ–ø–∏—é –≤ /tmp/ls_backup_$(date +%Y%m%d_%H%M%S)..."
BACKUP_DIR="/tmp/ls_backup_$(date +%Y%m%d_%H%M%S)"
mkdir -p "$BACKUP_DIR"
cp -r /var/www/ls "$BACKUP_DIR/" 2>/dev/null || echo "   ‚ö†Ô∏è  –ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ–∑–¥–∞—Ç—å —Ä–µ–∑–µ—Ä–≤–Ω—É—é –∫–æ–ø–∏—é (–º–æ–∂–Ω–æ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å)"

# –£–¥–∞–ª—è–µ–º –ø–∞–ø–∫—É
echo ""
echo "üóëÔ∏è  –£–¥–∞–ª—è–µ–º /var/www/ls..."
if rm -rf /var/www/ls; then
    echo -e "${GREEN}‚úÖ –ü–∞–ø–∫–∞ /var/www/ls —É—Å–ø–µ—à–Ω–æ —É–¥–∞–ª–µ–Ω–∞${NC}"
    echo ""
    echo "üì¶ –†–µ–∑–µ—Ä–≤–Ω–∞—è –∫–æ–ø–∏—è (–µ—Å–ª–∏ —Å–æ–∑–¥–∞–Ω–∞): $BACKUP_DIR"
    echo "   –í—ã –º–æ–∂–µ—Ç–µ —É–¥–∞–ª–∏—Ç—å –µ—ë –≤—Ä—É—á–Ω—É—é, –µ—Å–ª–∏ –≤—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ"
else
    echo -e "${RED}‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –ø–∞–ø–∫–∏${NC}"
    exit 1
fi

echo ""
echo -e "${GREEN}‚úÖ –ì–æ—Ç–æ–≤–æ!${NC}"

