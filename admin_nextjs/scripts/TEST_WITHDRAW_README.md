# –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—ã–≤–æ–¥–∞ —á–µ—Ä–µ–∑ MobCash API –¥–ª—è 1xbet

–≠—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Ä–∞–±–æ—Ç—É –Ω–æ–≤–æ–≥–æ API –≤—ã–≤–æ–¥–∞ –¥–ª—è 1xbet, –∫–æ—Ç–æ—Ä–æ–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ 2 —à–∞–≥–∞:
1. **–ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–¥–∞ –∏ –ø–æ–ª—É—á–µ–Ω–∏–µ —Å—É–º–º—ã** (`mobile.getWithdrawalAmount`)
2. **–í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –≤—ã–≤–æ–¥–∞** (`mobile.withdrawal`)

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ë–∞–∑–æ–≤—ã–π –∑–∞–ø—É—Å–∫

```bash
npm run test:withdraw
```

–∏–ª–∏

```bash
npx tsx scripts/test-1xbet-withdraw.ts
```

### –° –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏

–í—ã –º–æ–∂–µ—Ç–µ —É–∫–∞–∑–∞—Ç—å —Å–≤–æ–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:

```bash
TEST_PAYER_ID=1085261647 TEST_WITHDRAWAL_CODE=bbbb npm run test:withdraw
```

## –ü–∞—Ä–∞–º–µ—Ç—Ä—ã

- `TEST_PAYER_ID` - ID –∞–∫–∫–∞—É–Ω—Ç–∞ –∏–≥—Ä–æ–∫–∞ –≤ –∫–∞–∑–∏–Ω–æ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: `1085261647`)
- `TEST_WITHDRAWAL_CODE` - –ö–æ–¥ –æ—Ä–¥–µ—Ä–∞ –Ω–∞ –≤—ã–≤–æ–¥ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: `bbbb`)

## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

### 1. –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è MobCash

–°–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–≥—Ä—É–∂–∞–µ—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –∏–∑:
1. –ë–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö (–Ω–∞—Å—Ç—Ä–æ–π–∫–∞ `1xbet_mobcash_config`)
2. –§–∞–π–ª–∞ `.mobcash_tokens.json` (—Å–æ–∑–¥–∞–Ω–Ω–æ–≥–æ Python —Å–∫—Ä–∏–ø—Ç–æ–º)
3. –ü–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è

### 2. –¢–æ–∫–µ–Ω—ã MobCash

–î–ª—è —Ä–∞–±–æ—Ç—ã API –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ç–æ–∫–µ–Ω—ã –æ–¥–Ω–∏–º –∏–∑ —Å–ø–æ—Å–æ–±–æ–≤:

#### –°–ø–æ—Å–æ–± 1: Python —Å–∫—Ä–∏–ø—Ç (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
```bash
cd admin_nextjs
python3 scripts/update_mobcash_tokens.py
```

–≠—Ç–æ —Å–æ–∑–¥–∞—Å—Ç —Ñ–∞–π–ª `.mobcash_tokens.json` —Å –∞–∫—Ç—É–∞–ª—å–Ω—ã–º–∏ —Ç–æ–∫–µ–Ω–∞–º–∏.

#### –°–ø–æ—Å–æ–± 2: –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
–î–æ–±–∞–≤—å—Ç–µ –≤ `.env`:
```env
MOBCASH_BEARER_TOKEN=ory_at_...
MOBCASH_USER_ID=1955911305411895296
MOBCASH_SESSION_ID=1986068554788577280
```

#### –°–ø–æ—Å–æ–± 3: –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
–î–æ–±–∞–≤—å—Ç–µ –≤ —Ç–∞–±–ª–∏—Ü—É `BotConfiguration` –∑–∞–ø–∏—Å—å —Å –∫–ª—é—á–æ–º `1xbet_mobcash_config`:
```json
{
  "login": "your_login",
  "password": "your_password",
  "cashdesk_id": "1001098",
  "bearer_token": "ory_at_...",
  "user_id": "1955911305411895296",
  "session_id": "1986068554788577280",
  "default_lat": 42.845778,
  "default_lon": 74.568778
}
```

## –ß—Ç–æ —Ç–µ—Å—Ç–∏—Ä—É–µ—Ç —Å–∫—Ä–∏–ø—Ç

1. ‚úÖ –ó–∞–≥—Ä—É–∑–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ MobCash
2. ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è —Ç–æ–∫–µ–Ω–æ–≤
3. ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–¥–∞ –∏ –ø–æ–ª—É—á–µ–Ω–∏–µ —Å—É–º–º—ã –æ—Ä–¥–µ—Ä–∞ (`mobile.getWithdrawalAmount`)
4. ‚ö†Ô∏è –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –≤—ã–≤–æ–¥–∞ (`mobile.withdrawal`) - **–∑–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–æ –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏**

## –í–∞–∂–Ω–æ!

**–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é —Å–∫—Ä–∏–ø—Ç –ù–ï –≤—ã–ø–æ–ª–Ω—è–µ—Ç —Ä–µ–∞–ª—å–Ω—ã–π –≤—ã–≤–æ–¥ —Å—Ä–µ–¥—Å—Ç–≤!**

–í—ã–≤–æ–¥ –∑–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω –≤ –∫–æ–¥–µ –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏. –ï—Å–ª–∏ –≤—ã —Ö–æ—Ç–∏—Ç–µ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–∞–ª—å–Ω—ã–π –≤—ã–≤–æ–¥:

1. –û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª `scripts/test-1xbet-withdraw.ts`
2. –ù–∞–π–¥–∏—Ç–µ —Å—Ç—Ä–æ–∫–∏ —Å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏ `// –†–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ –¥–ª—è —Ä–µ–∞–ª—å–Ω–æ–≥–æ –≤—ã–≤–æ–¥–∞:`
3. –†–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π –∫–æ–¥
4. **–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—ã –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ!**

## –ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞

```
üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—ã–≤–æ–¥–∞ —á–µ—Ä–µ–∑ MobCash API –¥–ª—è 1xbet

üìã –ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Ç–µ—Å—Ç–∞:
   Payer ID: 1085261647
   Withdrawal Code: bbbb

üîß –ü–æ–ª—É—á–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ MobCash...
‚úÖ –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø–æ–ª—É—á–µ–Ω–∞:
   Login: burgoevk
   Cashdesk ID: 1001098
   Bearer Token: ‚úÖ –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
   User ID: ‚úÖ –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
   Session ID: ‚úÖ –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
   Location: lat=42.845778, lon=74.568778

üìù –®–∞–≥ 1: –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–¥–∞ –∏ –ø–æ–ª—É—á–µ–Ω–∏–µ —Å—É–º–º—ã –æ—Ä–¥–µ—Ä–∞ (mobile.getWithdrawalAmount)...
‚úÖ –ö–æ–¥ –ø—Ä–æ–≤–µ—Ä–µ–Ω —É—Å–ø–µ—à–Ω–æ!
   –°—É–º–º–∞ –æ—Ä–¥–µ—Ä–∞: 10000

üí∞ –®–∞–≥ 2: –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –≤—ã–≤–æ–¥–∞ (mobile.withdrawal)...
‚ö†Ô∏è  –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –≤—ã–≤–æ–¥–∞ –ø—Ä–æ–ø—É—â–µ–Ω–æ (–∑–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–æ –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏)
   –†–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ –∫–æ–¥ –≤ —Å–∫—Ä–∏–ø—Ç–µ, –µ—Å–ª–∏ —Ö–æ—Ç–∏—Ç–µ —Ä–µ–∞–ª—å–Ω–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å –≤—ã–≤–æ–¥.

‚úÖ –í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ–π–¥–µ–Ω—ã —É—Å–ø–µ—à–Ω–æ!
```

## –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫

### –û—à–∏–±–∫–∞: "OAuth2 authentication failed"

**–ü—Ä–∏—á–∏–Ω–∞:** –¢–æ–∫–µ–Ω—ã –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –∏–ª–∏ –∏—Å—Ç–µ–∫–ª–∏.

**–†–µ—à–µ–Ω–∏–µ:**
1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ Python —Å–∫—Ä–∏–ø—Ç –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ç–æ–∫–µ–Ω–æ–≤:
   ```bash
   python3 scripts/update_mobcash_tokens.py
   ```
2. –ò–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —Ç–æ–∫–µ–Ω—ã –≤—Ä—É—á–Ω—É—é —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –∏–ª–∏ –ë–î

### –û—à–∏–±–∫–∞: "–ö–æ–¥ –Ω–µ–≤–µ—Ä–Ω—ã–π –∏–ª–∏ –≤—ã–≤–æ–¥ –Ω–µ –Ω–∞–π–¥–µ–Ω"

**–ü—Ä–∏—á–∏–Ω–∞:** –ö–æ–¥ –æ—Ä–¥–µ—Ä–∞ –Ω–µ–≤–µ—Ä–Ω—ã–π –∏–ª–∏ –æ—Ä–¥–µ—Ä –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç.

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å –∫–æ–¥–∞
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –æ—Ä–¥–µ—Ä –Ω–∞ –≤—ã–≤–æ–¥ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ —Å–æ–∑–¥–∞–Ω –≤ –∫–∞–∑–∏–Ω–æ
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ `TEST_PAYER_ID` —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –∞–∫–∫–∞—É–Ω—Ç—É –∏–≥—Ä–æ–∫–∞

### –û—à–∏–±–∫–∞: "–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è MobCash –Ω–µ –Ω–∞–π–¥–µ–Ω–∞"

**–ü—Ä–∏—á–∏–Ω–∞:** –ù–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è MobCash.

**–†–µ—à–µ–Ω–∏–µ:**
1. –î–æ–±–∞–≤—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫—É –≤ –ë–î —Å –∫–ª—é—á–æ–º `1xbet_mobcash_config`
2. –ò–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è `MOBCASH_LOGIN`, `MOBCASH_PASSWORD`, `MOBCASH_CASHDESK_ID`

## –°–≤—è–∑–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

- `lib/mob-cash-api.ts` - –ö–ª–∏–µ–Ω—Ç MobCash API
- `lib/casino-withdraw.ts` - –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –≤—ã–≤–æ–¥–æ–º
- `lib/deposit-balance.ts` - –ü–æ–ª—É—á–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ MobCash
- `app/api/withdraw-check/route.ts` - API endpoint –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤—ã–≤–æ–¥–∞

