# –ë—ã—Å—Ç—Ä–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ MobCash API (–ì–∏–±—Ä–∏–¥–Ω—ã–π —Ä–µ–∂–∏–º - –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

## ‚ö†Ô∏è –í–∞–∂–Ω–æ: MobCash API —Ç—Ä–µ–±—É–µ—Ç client_secret

MobCash API —Ç—Ä–µ–±—É–µ—Ç `client_secret` –¥–ª—è –æ–±–º–µ–Ω–∞ authorization code –Ω–∞ access token, –∫–æ—Ç–æ—Ä—ã–π –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω –ø—É–±–ª–∏—á–Ω–æ. 

**–†–µ—à–µ–Ω–∏–µ**: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ **–≥–æ—Ç–æ–≤—ã–µ —Ç–æ–∫–µ–Ω—ã –∏–∑ –±—Ä–∞—É–∑–µ—Ä–∞** + **–ª–æ–≥–∏–Ω/–ø–∞—Ä–æ–ª—å –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è**.

–°–∏—Å—Ç–µ–º–∞ –±—É–¥–µ—Ç:
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≥–æ—Ç–æ–≤—ã–µ —Ç–æ–∫–µ–Ω—ã –∏–∑ `.env` (–±—ã—Å—Ç—Ä–æ)
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–ª—è—Ç—å –∏—Ö —á–µ—Ä–µ–∑ OAuth2 flow –ø—Ä–∏ –∏—Å—Ç–µ—á–µ–Ω–∏–∏ (–µ—Å–ª–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –ª–æ–≥–∏–Ω/–ø–∞—Ä–æ–ª—å)

## üìã –¢—Ä–µ–±—É–µ–º—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –≤ .env:

```env
# MobCash API - –ì–æ—Ç–æ–≤—ã–µ —Ç–æ–∫–µ–Ω—ã (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)
MOBCASH_BEARER_TOKEN="ory_at_..."
MOBCASH_USER_ID="1985621306577461248"
MOBCASH_SESSION_ID="1988638502723461120"

# MobCash API - –õ–æ–≥–∏–Ω/–ø–∞—Ä–æ–ª—å –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
MOBCASH_LOGIN="burgoevk"
MOBCASH_PASSWORD="Kanat312###"
MOBCASH_CASHDESK_ID="1001098"
MOBCASH_DEFAULT_LAT=42.845778
MOBCASH_DEFAULT_LON=74.568778
```

## üîß –ö–∞–∫ –ø–æ–ª—É—á–∏—Ç—å —Ç–æ–∫–µ–Ω—ã –∏–∑ –±—Ä–∞—É–∑–µ—Ä–∞:

1. –û—Ç–∫—Ä–æ–π—Ç–µ https://app.mob-cash.com –≤ –±—Ä–∞—É–∑–µ—Ä–µ
2. –í–æ–π–¥–∏—Ç–µ –≤ —Å–∏—Å—Ç–µ–º—É
3. –û—Ç–∫—Ä–æ–π—Ç–µ DevTools (F12) ‚Üí Network
4. –ù–∞–π–¥–∏—Ç–µ –∑–∞–ø—Ä–æ—Å –∫ `/api/` —Å –º–µ—Ç–æ–¥–æ–º `mobile.login`
5. –í –∑–∞–≥–æ–ª–æ–≤–∫–∞—Ö –∑–∞–ø—Ä–æ—Å–∞ –Ω–∞–π–¥–∏—Ç–µ:
   - `Authorization: Bearer ory_at_...` ‚Üí —ç—Ç–æ `MOBCASH_BEARER_TOKEN`
   - –í —Ç–µ–ª–µ –∑–∞–ø—Ä–æ—Å–∞ –Ω–∞–π–¥–∏—Ç–µ `userID` ‚Üí —ç—Ç–æ `MOBCASH_USER_ID`
   - –í —Ç–µ–ª–µ –∑–∞–ø—Ä–æ—Å–∞ –Ω–∞–π–¥–∏—Ç–µ `sessionID` ‚Üí —ç—Ç–æ `MOBCASH_SESSION_ID`

## ‚ö†Ô∏è –í–∞–∂–Ω–æ: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ

MobCash API —Ç—Ä–µ–±—É–µ—Ç `client_secret` –¥–ª—è –æ–±–º–µ–Ω–∞ authorization code –Ω–∞ access token. –ë–µ–∑ `client_secret` –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤ —á–µ—Ä–µ–∑ OAuth2 **–Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ**.

## ‚úÖ –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:

- **–°–Ω–∞—á–∞–ª–∞**: –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –≥–æ—Ç–æ–≤—ã–µ —Ç–æ–∫–µ–Ω—ã –∏–∑ `.env` (–±—ã—Å—Ç—Ä–æ)
- **–ü—Ä–∏ –∏—Å—Ç–µ—á–µ–Ω–∏–∏ (401)**: –°–∏—Å—Ç–µ–º–∞ –ø–æ–ø—ã—Ç–∞–µ—Ç—Å—è –≤—ã–ø–æ–ª–Ω–∏—Ç—å OAuth2 flow, –Ω–æ –Ω–µ —Å–º–æ–∂–µ—Ç –ø–æ–ª—É—á–∏—Ç—å –Ω–æ–≤—ã–π —Ç–æ–∫–µ–Ω –±–µ–∑ `client_secret`
- **–†–µ—à–µ–Ω–∏–µ**: –û–±–Ω–æ–≤–ª—è–π—Ç–µ —Ç–æ–∫–µ–Ω—ã –≤—Ä—É—á–Ω—É—é –∏–∑ –±—Ä–∞—É–∑–µ—Ä–∞ (—Å–º. `MOBCASH_MANUAL_TOKEN_UPDATE.md`)

## üìù –ß—Ç–æ –¥–µ–ª–∞—Ç—å –ø—Ä–∏ –∏—Å—Ç–µ—á–µ–Ω–∏–∏ —Ç–æ–∫–µ–Ω–æ–≤:

1. –ü–æ–ª—É—á–∏—Ç–µ –Ω–æ–≤—ã–µ —Ç–æ–∫–µ–Ω—ã –∏–∑ –±—Ä–∞—É–∑–µ—Ä–∞ (—Å–º. –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é –≤—ã—à–µ)
2. –û–±–Ω–æ–≤–∏—Ç–µ –∏—Ö –≤ `.env` —Ñ–∞–π–ª–µ
3. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–∏—Å: `pm2 restart nextjs-admin`

## üöÄ –ü–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:

1. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é:**
   ```bash
   cd admin_nextjs
   npm run check-mobcash-config
   ```
   
   –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `npx`:
   ```bash
   npx tsx scripts/check-mobcash-config.ts
   ```

2. **–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–∏—Å:**
   ```bash
   pm2 restart luxon-email-watcher
   ```

3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏:**
   ```bash
   pm2 logs luxon-email-watcher --lines 100
   ```

4. **–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
   - –ü—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—Ä–æ—Å–µ: `[MobCash Auth] üîÑ Starting OAuth2 flow with login: burgoevk`
   - –ü—Ä–∏ —É—Å–ø–µ—à–Ω–æ–π –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏: `[MobCash Auth] ‚úÖ OAuth2 flow completed successfully`
   - –ü—Ä–∏ –∏—Å—Ç–µ—á–µ–Ω–∏–∏ —Ç–æ–∫–µ–Ω–æ–≤: –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ OAuth2

## ‚úÖ –ì–æ—Ç–æ–≤–æ!

–°–∏—Å—Ç–µ–º–∞ —Ç–µ–ø–µ—Ä—å –±—É–¥–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–ª—è—Ç—å —Ç–æ–∫–µ–Ω—ã –ø—Ä–∏ –∏—Å—Ç–µ—á–µ–Ω–∏–∏. –ù–∏–∫–∞–∫–∏—Ö —Ä—É—á–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è!

