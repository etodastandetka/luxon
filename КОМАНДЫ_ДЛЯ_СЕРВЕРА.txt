â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸš€ ĞšĞĞœĞĞĞ”Ğ« Ğ”Ğ›Ğ¯ Ğ”Ğ•ĞŸĞ›ĞĞ¯ ĞĞ Ğ¡Ğ•Ğ Ğ’Ğ•Ğ 
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

1. ĞĞ‘ĞĞĞ’Ğ›Ğ•ĞĞ˜Ğ• ĞšĞĞ”Ğ Ğ˜ Ğ‘ĞĞ—Ğ« Ğ”ĞĞĞĞ«Ğ¥
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
git pull origin main
cd admin_nextjs
npm run db:push
npm run db:generate
cd ..


2. Ğ¡Ğ‘ĞĞ ĞšĞ ĞŸĞ ĞĞ•ĞšĞ¢ĞĞ’
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# ĞĞ´Ğ¼Ğ¸Ğ½ĞºĞ°
cd admin_nextjs
npm install --production
npm run build
cd ..

# ĞšĞ»Ğ¸ĞµĞ½Ñ‚ÑĞºĞ¸Ğ¹ ÑĞ°Ğ¹Ñ‚
cd bot2/mini_app_site
npm install --production
npm run build
cd ../..


3. ĞŸĞ•Ğ Ğ•Ğ—ĞĞŸĞ£Ğ¡Ğš PM2
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
pm2 restart all

# Ğ˜Ğ»Ğ¸ ĞµÑĞ»Ğ¸ Ğ½ÑƒĞ¶Ğ½Ğ¾ Ğ¿ĞµÑ€ĞµĞ·Ğ°Ğ¿ÑƒÑÑ‚Ğ¸Ñ‚ÑŒ Ñ Ğ½ÑƒĞ»Ñ:
pm2 stop all
cd admin_nextjs && pm2 start ecosystem.config.js --env production
cd ../bot2/mini_app_site && pm2 start ecosystem.config.js --env production
pm2 save


4. ĞĞ‘ĞĞĞ’Ğ›Ğ•ĞĞ˜Ğ• NGINX
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
sudo cp nginx-configs/japar.click.cloudflare.conf /etc/nginx/sites-available/japar.click
sudo cp nginx-configs/luxon.dad.cloudflare.conf /etc/nginx/sites-available/luxon.dad
sudo nginx -t
sudo systemctl reload nginx


5. ĞŸĞ ĞĞ’Ğ•Ğ ĞšĞ Ğ ĞĞ‘ĞĞ¢Ğ«
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
pm2 status
pm2 logs

# ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° API
curl -I http://127.0.0.1:3001/api/public/payment-settings
curl -I http://127.0.0.1:3030

# ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° ÑĞ°Ğ¹Ñ‚Ğ¾Ğ²
curl -I https://japar.click
curl -I https://luxon.dad


6. ĞĞĞ¡Ğ¢Ğ ĞĞ™ĞšĞ 2FA (ĞĞŸĞ¦Ğ˜ĞĞĞĞ›Ğ¬ĞĞ)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
cd admin_nextjs
export DATABASE_URL='postgresql://user:password@localhost:5432/luxon_admin'
pip install -r scripts/requirements-2fa.txt
python scripts/generate-2fa-qr.py admin --save


7. ĞĞĞ¡Ğ¢Ğ ĞĞ™ĞšĞ Ğ“Ğ•ĞĞ›ĞĞšĞĞ¦Ğ˜Ğ˜
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# Ğ’Ğ°Ñ€Ğ¸Ğ°Ğ½Ñ‚ 1: Ğ§ĞµÑ€ĞµĞ· .env Ñ„Ğ°Ğ¹Ğ»
# Ğ”Ğ¾Ğ±Ğ°Ğ²ÑŒÑ‚Ğµ Ğ² admin_nextjs/.env:
# ALLOWED_LATITUDE=42.84877
# ALLOWED_LONGITUDE=74.57028
# ALLOWED_RADIUS_METERS=10

# Ğ’Ğ°Ñ€Ğ¸Ğ°Ğ½Ñ‚ 2: Ğ§ĞµÑ€ĞµĞ· API (Ğ¿Ğ¾ÑĞ»Ğµ Ğ²Ñ…Ğ¾Ğ´Ğ° Ğ² Ğ°Ğ´Ğ¼Ğ¸Ğ½ĞºÑƒ)
curl -X POST https://japar.click/api/geolocation/settings \
  -H "Cookie: auth_token=YOUR_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "latitude": 42.84877,
    "longitude": 74.57028,
    "radius": 10
  }'


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
âœ… Ğ’Ğ¡Ğ• Ğ“ĞĞ¢ĞĞ’Ğ!
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Ğ—Ğ°Ñ‰Ğ¸Ñ‚Ğ° Ğ½Ğ°ÑÑ‚Ñ€Ğ¾ĞµĞ½Ğ°:
âœ… Rate limiting
âœ… Ğ‘Ğ»Ğ¾ĞºĞ¸Ñ€Ğ¾Ğ²ĞºĞ° IP Ğ½Ğ° 24 Ñ‡Ğ°ÑĞ°
âœ… Ğ—Ğ°Ñ‰Ğ¸Ñ‚Ğ° Ğ¾Ñ‚ SQL Ğ¸Ğ½ÑŠĞµĞºÑ†Ğ¸Ğ¹ Ğ¸ XSS
âœ… Ğ’Ğ½ÑƒÑ‚Ñ€ĞµĞ½Ğ½Ğ¸Ğµ Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑÑ‹ Ğ½Ğµ Ğ±Ğ»Ğ¾ĞºĞ¸Ñ€ÑƒÑÑ‚ÑÑ
âœ… API Ğ¼ĞµĞ¶Ğ´Ñƒ ĞºĞ»Ğ¸ĞµĞ½Ñ‚ÑĞºĞ¸Ğ¼ ÑĞ°Ğ¹Ñ‚Ğ¾Ğ¼ Ğ¸ Ğ°Ğ´Ğ¼Ğ¸Ğ½ĞºĞ¾Ğ¹ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚

ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑŒÑ‚Ğµ:
- https://japar.click (Ğ°Ğ´Ğ¼Ğ¸Ğ½ĞºĞ°)
- https://luxon.dad (ĞºĞ»Ğ¸ĞµĞ½Ñ‚ÑĞºĞ¸Ğ¹ ÑĞ°Ğ¹Ñ‚)
- pm2 logs (Ğ»Ğ¾Ğ³Ğ¸)

