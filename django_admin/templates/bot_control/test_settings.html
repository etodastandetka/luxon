{% extends 'base.html' %}

{% block title %}Тест настроек{% endblock %}

{% block content %}
<div class="card">
    <h2>Тест API настроек</h2>
    
    <div id="test-results">
        <p>Загрузка...</p>
    </div>
    
    <button onclick="testAPI()">Тестировать API</button>
</div>

<script>
async function testAPI() {
    const results = document.getElementById('test-results');
    results.innerHTML = '<p>Тестирование...</p>';
    
    try {
        // Тест 1: Bot Control API
        const botResponse = await fetch('/bot/api/bot-control/');
        const botData = await botResponse.json();
        console.log('Bot Control API:', botData);
        
        // Тест 2: Deposit Settings API
        const depositResponse = await fetch('/bot/api/deposit-settings/');
        const depositData = await depositResponse.json();
        console.log('Deposit Settings API:', depositData);
        
        // Тест 3: Withdrawal Settings API
        const withdrawalResponse = await fetch('/bot/api/withdrawal-settings/');
        const withdrawalData = await withdrawalResponse.json();
        console.log('Withdrawal Settings API:', withdrawalData);
        
        results.innerHTML = `
            <div style="color: green;">
                <h3>✅ Все API работают!</h3>
                <p><strong>Bot Control:</strong> ${JSON.stringify(botData)}</p>
                <p><strong>Deposit Settings:</strong> ${JSON.stringify(depositData)}</p>
                <p><strong>Withdrawal Settings:</strong> ${JSON.stringify(withdrawalData)}</p>
            </div>
        `;
        
    } catch (error) {
        console.error('API Error:', error);
        results.innerHTML = `
            <div style="color: red;">
                <h3>❌ Ошибка API</h3>
                <p>${error.message}</p>
            </div>
        `;
    }
}

// Автоматически запускаем тест при загрузке
document.addEventListener('DOMContentLoaded', testAPI);
</script>
{% endblock %}
